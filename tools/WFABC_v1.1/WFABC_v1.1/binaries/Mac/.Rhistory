setwd("~/Dropbox/Work/WF_sim_c/distributed/binaries/Mac")
system("./wfabc_1 multiple_loci.txt ")
post_N=read.table("multiple_loci_Ne_bootstrap.txt")
plot(density(post_N[,1]),lwd=2,main="Ne Posterior",xlab="Ne")
system("./wfabc_2 -min_s -0.5 -max_s 0.5 multiple_loci.txt")
post_s=read.table("multiple_loci_posterior_s.txt")
plot(density(t(post_s[1,])),lwd=2,main="s Posterior (locus 1)",xlab="s")
plot(density(t(post_s[1000,])),lwd=2,main="s Posterior (locus 1000)",xlab="s")
post_N=read.table("multiple_loci_posterior_N.txt")
require(boa)
apply(post_s,1,boa.hpd,1-0.95)
boxplot(rowMeans(post_s[1:990,]),rowMeans(post_s[991:1000,]),names=c("neutral","selected"))
system("./wfabc_2 -min_s -0.5 -max_s 0.5 -max_sims 100 multiple_loci.txt")
